(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-04f8a276"],{e007:function(e,t,a){"use strict";var s=a("ef88"),n=a.n(s);n.a},e8b1:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"search"},[a("Row",[a("Col",[a("Card",[a("Row",[a("Form",{ref:"searchForm",staticClass:"search-form",attrs:{model:e.searchForm,inline:"","label-width":70}},[a("Form-item",{attrs:{label:"标题",prop:"title"}},[a("Input",{staticStyle:{width:"200px"},attrs:{type:"text",clearable:"",placeholder:"请输入文章标题"},model:{value:e.searchForm.title,callback:function(t){e.$set(e.searchForm,"title",t)},expression:"searchForm.title"}})],1),a("Form-item",{attrs:{label:"是否展示",prop:"status"}},[a("Select",{staticStyle:{width:"200px"},attrs:{placeholder:"请选择是否展示",clearable:""},model:{value:e.searchForm.status,callback:function(t){e.$set(e.searchForm,"status",t)},expression:"searchForm.status"}},[a("Option",{attrs:{value:"0"}},[e._v("否")]),a("Option",{attrs:{value:"1"}},[e._v("是")])],1)],1),a("Form-item",{attrs:{label:"分类",prop:"category"}},[a("Cascader",{staticStyle:{width:"200px"},attrs:{data:e.category,"load-data":e.loadData,"change-on-select":"",filterable:"",placeholder:"请选择或输入搜索分类"},on:{"on-change":e.handleChangeDep},model:{value:e.selectDep,callback:function(t){e.selectDep=t},expression:"selectDep"}})],1),a("Form-item",{attrs:{label:"创建时间"}},[a("DatePicker",{staticStyle:{width:"200px"},attrs:{type:"daterange",format:"yyyy-MM-dd",clearable:"",placeholder:"选择起始时间"},on:{"on-change":e.selectDateRange},model:{value:e.selectDate,callback:function(t){e.selectDate=t},expression:"selectDate"}})],1),a("Form-item",{staticClass:"br",staticStyle:{"margin-left":"-35px"}},[a("Button",{attrs:{type:"primary",icon:"ios-search"},on:{click:e.handleSearch}},[e._v("搜索")]),a("Button",{on:{click:e.handleReset}},[e._v("重置")])],1)],1)],1),a("Row",{staticClass:"operation"},[a("Button",{directives:[{name:"has",rawName:"v-has",value:"add",expression:"'add'"}],attrs:{type:"primary",icon:"md-add"},on:{click:e.add}},[e._v("新增文章")]),a("Button",{directives:[{name:"has",rawName:"v-has",value:"delete",expression:"'delete'"}],attrs:{icon:"md-trash"},on:{click:e.delAll}},[e._v("批量删除")]),a("Dropdown",{on:{"on-click":e.handleDropdown}},[a("Button",[e._v("\n                            更多操作\n                            "),a("Icon",{attrs:{type:"md-arrow-dropdown"}})],1),a("DropdownMenu",{attrs:{slot:"list"},slot:"list"},[a("DropdownItem",{attrs:{name:"refresh"}},[e._v("刷新")]),a("DropdownItem",{attrs:{name:"exportData"}},[e._v("导出所选数据")])],1)],1),a("Dropdown",{staticStyle:{float:"right"},on:{"on-click":e.handleDropdown}},[a("Button",[e._v("\n                            设置显示列\n                            "),a("Icon",{attrs:{type:"md-arrow-dropdown"}})],1),a("DropdownMenu",{staticStyle:{padding:"10px"},attrs:{slot:"list"},slot:"list"},[a("Checkbox-group",{on:{"on-change":e.changeTableColumns},model:{value:e.tableColumnsChecked,callback:function(t){e.tableColumnsChecked=t},expression:"tableColumnsChecked"}},e._l(e.allColumns,(function(t){return a("Checkbox",{attrs:{label:t.key}},[e._v(e._s(t.title))])})),1)],1)],1)],1),a("Row",[a("Alert",{attrs:{"show-icon":""}},[e._v("\n                        已选择 "),a("span",{staticClass:"select-count"},[e._v(e._s(e.selectCount))]),e._v(" 项\n                        "),a("a",{staticClass:"select-clear",on:{click:e.clearSelectAll}},[e._v("清空")])])],1),a("Row",[a("Table",{ref:"table",attrs:{loading:e.loading,border:"",columns:e.columns,data:e.data,sortable:"custom"},on:{"on-sort-change":e.changeSort,"on-selection-change":e.showSelect}}),a("Table",{ref:"exportTable",staticStyle:{display:"none"},attrs:{columns:e.columns,data:e.exportData}})],1),a("Row",{staticClass:"page",attrs:{type:"flex",justify:"end"}},[a("Page",{attrs:{current:e.searchForm.pageNumber,total:e.total,"page-size":e.searchForm.pageSize,"page-size-opts":[10,20,50],size:"small","show-total":"","show-elevator":"","show-sizer":""},on:{"on-change":e.changePage,"on-page-size-change":e.changePageSize}})],1)],1)],1)],1)],1)},n=[],i=(a("ed63"),a("8cf2"),a("6d57"),a("365c")),r=a("23d5"),o=a.n(r),l={name:"article-manage",data:function(){var e=this;return{accessToken:{},loading:!0,drop:!1,dropDownContent:"展开",dropDownIcon:"ios-arrow-down",selectCount:0,imageDomain:"",selectList:[],category:[],selectDep:[],permTypes:[],tableColumnsChecked:["thumb","title","categoryTitle","status","createdAt"],searchForm:{title:"",content:"",status:null,startDate:"",endDate:"",summary:""},selectDate:null,modalType:0,columns:[],allColumns:[{title:"缩略图",key:"thumb",align:"center",render:function(t,a){return a.row.thumb?t("div",{attrs:{style:""}},[t("img",{props:{type:"primary",size:"small"},attrs:{src:e.imageDomain+a.row.thumb,style:"width: 90px;height: 90px;border-radius: 2px;"},style:"text-align:center;margin:3px auto;"})]):t("div","-")}},{title:"标题",key:"title",sortable:!0,align:"center"},{title:"简介",key:"summary",sortable:!0,align:"center",type:"html"},{title:"分类",key:"categoryTitle",align:"center",render:function(e,t){return""===t.row.categoryTitle?e("div","-"):e("div",t.row.categoryTitle)}},{title:"作者",key:"author",sortable:!0,align:"center"},{title:"是否展示",key:"status",align:"center",render:function(e,t){var a="";return 0===t.row.status?a="否":1===t.row.status&&(a="是"),e("div",a)},filters:[{label:"是",value:1},{label:"否",value:0}],filterMultiple:!1,filterMethod:function(e,t){return 0===e?0===t.status:1===e?1===t.status:void 0}},{title:"创建时间",key:"createdAt",sortable:!0,sortType:"desc",render:function(e,t){return e("div",o()(1e3*t.row.createdAt).format("YYYY-MM-DD HH:mm:ss"))}}],data:[],exportData:[],total:0}},methods:{init:function(){this.accessToken={accessToken:this.getStore("accessToken")},this.changeTableColumns(),this.$refs.ueditor={},this.getImageBase(),this.initMeta(),this.initCategoryData(),this.getArticleList()},initMeta:function(){var e=this.$route.meta.permTypes;null!==e&&void 0!==e&&(this.permTypes=e)},changePage:function(e){this.searchForm.pageNumber=e,this.getArticleList(),this.clearSelectAll()},changePageSize:function(e){this.searchForm.pageSize=e,this.getArticleList()},selectDateRange:function(e){e&&(this.searchForm.startDate=e[0],this.searchForm.endDate=e[1])},getArticleList:function(){var e=this;this.loading=!0,Object(i["L"])(this.searchForm).then((function(t){e.loading=!1,!0===t.success&&(e.data=t.result.records,e.total=t.result.total)}))},handleSearch:function(){this.searchForm.pageNumber=1,this.searchForm.pageSize=10,this.getArticleList()},handleReset:function(){this.$refs.searchForm.resetFields(),this.searchForm.pageNumber=1,this.searchForm.pageSize=10,this.selectDate=null,this.searchForm.startDate="",this.searchForm.endDate="",this.searchForm.categoryId="",this.getArticleList()},changeSort:function(e){this.searchForm.sort=e.key,this.searchForm.order=e.order,"normal"===e.order&&(this.searchForm.order=""),this.getArticleList()},handleDropdown:function(e){var t=this;if("exportData"===e){if(this.selectCount<=0)return void this.$Message.warning("您还未选择要导出的数据");this.$Modal.confirm({title:"确认导出",content:"您确认要导出所选 "+this.selectCount+" 条数据?",onOk:function(){t.$refs.exportTable.exportCsv({filename:"文章数据"})}})}else"refresh"===e&&this.getArticleList()},add:function(){this.$router.push({name:"article_edit",query:{type:"add"}})},enable:function(e){var t=this;this.$Modal.confirm({title:"确认启用",content:"您确认要启用文章 "+e.title+" ?",onOk:function(){Object(i["F"])(e.id).then((function(e){!0===e.success&&(t.$Message.success("操作成功"),t.getArticleList())}))}})},disable:function(e){var t=this;this.$Modal.confirm({title:"确认禁用",content:"您确认要禁用文章 "+e.title+" ?",onOk:function(){Object(i["t"])(e.id).then((function(e){!0===e.success&&(t.$Message.success("操作成功"),t.getArticleList())}))}})},remove:function(e){var t=this;this.$Modal.confirm({title:"确认删除",content:"您确认要删除文章 "+e.title+" ?",onOk:function(){Object(i["k"])(e.id).then((function(e){!0===e.success&&(t.$Message.success("删除成功"),t.getArticleList())}))}})},dropDown:function(){this.drop?(this.dropDownContent="展开",this.dropDownIcon="ios-arrow-down"):(this.dropDownContent="收起",this.dropDownIcon="ios-arrow-up"),this.drop=!this.drop},showSelect:function(e){this.exportData=e,this.selectList=e,this.selectCount=e.length},clearSelectAll:function(){this.$refs.table.selectAll(!1)},delAll:function(){var e=this;this.selectCount<=0?this.$Message.warning("您还未选择要删除的数据"):this.$Modal.confirm({title:"确认删除",content:"您确认要删除所选的 "+this.selectCount+" 条数据?",onOk:function(){var t="";e.selectList.forEach((function(e){t+=e.id+","})),t=t.substring(0,t.length-1),Object(i["k"])(t).then((function(t){!0===t.success&&(e.$Message.success("删除成功"),e.clearSelectAll(),e.getArticleList())}))}})},initCategoryData:function(){var e=this;Object(i["Y"])(0).then((function(t){!0===t.success&&(t.result.forEach((function(e){e.isParent?(e.value=e.id,e.label=e.title,e.loading=!1,e.children=[]):(e.value=e.id,e.label=e.title)})),e.deleteDisableNode(t.result),e.category=t.result)}))},deleteDisableNode:function(e){var t=this;e.forEach((function(e){0===e.status&&(e.title="[已禁用] "+e.title,e.disabled=!0),e.children&&e.children.length>0&&t.deleteDisableNode(e.children)}))},loadData:function(e,t){var a=this;e.loading=!0,Object(i["Y"])(e.value).then((function(s){e.loading=!1,!0===s.success&&(s.result.forEach((function(e){e.isParent?(e.value=e.id,e.label=e.title,e.loading=!1,e.children=[]):(e.value=e.id,e.label=e.title)})),a.deleteDisableNode(s.result),e.children=s.result,t())}))},loadDataTree:function(e,t){Object(i["Y"])(e.id).then((function(e){!0===e.success&&(e.result.forEach((function(e){e.isParent&&(e.loading=!1,e.children=[])})),t(e.result))}))},selectTree:function(e){if(e.length>0){for(var t in e[0])null===e[0][t]&&(e[0][t]="");var a=JSON.stringify(e[0]),s=JSON.parse(a);this.articleForm.categoryId=s.id,this.articleForm.categoryTitle=s.title}},clearSelectDep:function(){this.articleForm.categoryId="",this.articleForm.categoryTitle=""},handleChangeDep:function(e,t){e&&e.length>0?this.searchForm.categoryId=e[e.length-1]:this.searchForm.categoryId=""},handleChangeUserFormDep:function(e,t){e&&e.length>0?this.articleForm.categoryId=e[e.length-1]:this.articleForm.categoryId=""},getImageBase:function(){var e=this;this.loading=!0,Object(i["S"])().then((function(t){e.loading=!1,!0===t.success&&(e.imageDomain=t.result)}))},changeTableColumns:function(){this.columns=this.getTableColumns()},getTableColumns:function(){var e=this,t=[],a={type:"selection",align:"center",fixed:"left"};t.push(a);var s={title:"操作",key:"action",align:"center",fixed:"right",render:function(t,a){var s,n,i,r;return e.permTypes.includes("edit")&&(s=t("Button",{props:{type:"primary",size:"small"},style:{marginRight:"5px"},on:{click:function(){var t=a.row.id;e.$router.push({name:"article_edit",query:{type:"edit",id:t}})}}},"编辑")),e.permTypes.includes("enable")&&(i=t("Button",{props:{type:"success",size:"small"},style:{marginRight:"5px"},on:{click:function(){e.enable(a.row)}}},"启用")),e.permTypes.includes("disable")&&(n=t("Button",{props:{size:"small"},style:{marginRight:"5px"},on:{click:function(){e.disable(a.row)}}},"禁用")),e.permTypes.includes("delete")&&(r=t("Button",{props:{type:"error",size:"small"},on:{click:function(){e.remove(a.row)}}},"删除")),1===a.row.status?t("div",[s,n,r]):t("div",[s,i,r])}},n=this;return this.allColumns.forEach((function(e){n.tableColumnsChecked.forEach((function(a){e.key===a&&t.push(e)}))})),t.push(s),t}},mounted:function(){this.init()}},c=l,h=(a("e007"),a("623f")),u=Object(h["a"])(c,s,n,!1,null,null,null);t["default"]=u.exports},ef88:function(e,t,a){}}]);